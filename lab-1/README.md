# Лабораторная работа №1 "Лучшие практики работы с Dockerfile"
## Цель
Создать 2 докер файла: с применением плохих практик и без.
## Задачи
1. Создание Dockerfile с применением плохих практик.
2. Создание Dockerfile без применения плохих практик.
## Ход работы
Был написан код для Node.js сервера.
### Создание Dockerfile с применением плохих практик
Был создан файл `bad-dockerfile` с использованием трех плохих практик.
#### 1. Использование latest версии образа
```
FROM ubuntu:latest
```
При обновлении версии образа сервисы контейнера могут перестать быть совместимы или непредсказуемо изменить логику работы.
#### 2. Использование неоптимального образа
```
FROM ubuntu:latest

...

RUN apt-get update && apt-get install curl -y

RUN curl -sL https://deb.nodesource.com/setup_18.x | bash \
  && apt-get install nodejs
```
Используется неоптимальный образ, для сервера Node.js существуют образы, специально подготовленные для создания серверов.
#### 3. Хранение чувствительной информации внутри Dockerfile
```
ENV PASSWORD="Pa$$w0rd"
```
При получении доступа к файлу злоумышленник получит секретны
### Создание Dockerfile без применения плохих практик.
Был создан файл `Dockerfile` без применения плохих практик.
#### 1. Использование конкретной версии образа
```
FROM node:21.1-alpine3.17
```
Нет зависимости от обновлений образа, образ всегда одинаковый.
#### 2. Использование оптимального образа
```
FROM node:21.1-alpine3.17
```
Используется специальный образ для серверов Node.js. Не требуется дополнительная установка пакетов, из образа исключены лишние пакеты.
#### 3. Хранение чувствительной внутри .env файла
```
ARG PASSWORD
ENV PASSWORD=$PASSWORD
```
Чувствиетльные переменные окружения хранятся в `.env` файле и указываются при запуске контейнера ключом `--env-file`.
## Вывод
При написании Dockerfile очень важно проверять содержимое на наличие плохих практик.\
При неправильном написании образ может быть зависим от внешних обновлений, иметь непредсказуемой поведение,\
содержать излишнюю чувствительную информацию и занимать значительно больше места:
```
$ docker images                                            
REPOSITORY                 TAG       IMAGE ID       CREATED         SIZE                                                                    
<none>                     <none>    686470a3dc26   6 seconds ago   193MB                                                                   
<none>                     <none>    e7e8c758a539   3 minutes ago   327MB
```